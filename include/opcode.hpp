#pragma once
#include <optional>
#include <utility>

enum AddressMode {
  IMPLIED = 0,
  IMMEDIATE_M = 1,
  IMMEDIATE_X = 2,
  IMMEDIATE_8 = 3,
  RELATIVE = 4,
  RELATIVE_LONG = 5,
  DIRECT_PAGE = 6,
  DIRECT_PAGE_INDEXED_X = 7,
  DIRECT_PAGE_INDEXED_Y = 8,
  DIRECT_PAGE_INDIRECT = 9,
  DIRECT_PAGE_INDEXED_INDIRECT = 10,
  DIRECT_PAGE_INDIRECT_INDEXED = 11,
  DIRECT_PAGE_INDIRECT_LONG = 12,
  DIRECT_PAGE_INDIRECT_INDEXED_LONG = 13,
  ABSOLUTE = 14,
  ABSOLUTE_INDEXED_X = 15,
  ABSOLUTE_INDEXED_Y = 16,
  ABSOLUTE_LONG = 17,
  ABSOLUTE_INDEXED_LONG = 18,
  STACK_RELATIVE = 19,
  STACK_RELATIVE_INDIRECT_INDEXED = 20,
  ABSOLUTE_INDIRECT = 21,
  ABSOLUTE_INDIRECT_LONG = 22,
  ABSOLUTE_INDEXED_INDIRECT = 23,
  IMPLIED_ACCUMULATOR = 24,
  MOVE = 25,
  STACK_ABSOLUTE = 26,
  PEI_DIRECT_PAGE_INDIRECT = 27,
};

enum Operation {
  ADC = 0,
  AND = 1,
  ASL = 2,
  BCC = 3,
  BCS = 4,
  BEQ = 5,
  BIT = 6,
  BMI = 7,
  BNE = 8,
  BPL = 9,
  BRA = 10,
  BRK = 11,
  BRL = 12,
  BVC = 13,
  BVS = 14,
  CLC = 15,
  CLD = 16,
  CLI = 17,
  CLV = 18,
  CMP = 19,
  COP = 20,
  CPX = 21,
  CPY = 22,
  DEC = 23,
  DEX = 24,
  DEY = 25,
  EOR = 26,
  INC = 27,
  INX = 28,
  INY = 29,
  JML = 30,
  JMP = 31,
  JSL = 32,
  JSR = 33,
  LDA = 34,
  LDX = 35,
  LDY = 36,
  LSR = 37,
  MVN = 38,
  MVP = 39,
  NOP = 40,
  ORA = 41,
  PEA = 42,
  PEI = 43,
  PER = 44,
  PHA = 45,
  PHB = 46,
  PHD = 47,
  PHK = 48,
  PHP = 49,
  PHX = 50,
  PHY = 51,
  PLA = 52,
  PLB = 53,
  PLD = 54,
  PLP = 55,
  PLX = 56,
  PLY = 57,
  REP = 58,
  ROL = 59,
  ROR = 60,
  RTI = 61,
  RTL = 62,
  RTS = 63,
  SBC = 64,
  SEC = 65,
  SED = 66,
  SEI = 67,
  SEP = 68,
  STA = 69,
  STP = 70,
  STX = 71,
  STY = 72,
  STZ = 73,
  TAX = 74,
  TAY = 75,
  TCD = 76,
  TCS = 77,
  TDC = 78,
  TRB = 79,
  TSB = 80,
  TSC = 81,
  TSX = 82,
  TXA = 83,
  TXS = 84,
  TXY = 85,
  TYA = 86,
  TYX = 87,
  WAI = 88,
  WDM = 89,
  XBA = 90,
  XCE = 91,
};

constexpr std::optional<size_t> argument_size_table[] = {
    0,  // IMPLIED
    {}, // IMMEDIATE_M
    {}, // IMMEDIATE_X
    1,  // IMMEDIATE_8
    1,  // RELATIVE
    2,  // RELATIVE_LONG
    1,  // DIRECT_PAGE
    1,  // DIRECT_PAGE_INDEXED_X
    1,  // DIRECT_PAGE_INDEXED_Y
    1,  // DIRECT_PAGE_INDIRECT
    1,  // DIRECT_PAGE_INDEXED_INDIRECT
    1,  // DIRECT_PAGE_INDIRECT_INDEXED
    1,  // DIRECT_PAGE_INDIRECT_LONG
    1,  // DIRECT_PAGE_INDIRECT_INDEXED_LONG
    2,  // ABSOLUTE
    2,  // ABSOLUTE_INDEXED_X
    2,  // ABSOLUTE_INDEXED_Y
    3,  // ABSOLUTE_LONG
    3,  // ABSOLUTE_INDEXED_LONG
    1,  // STACK_RELATIVE
    1,  // STACK_RELATIVE_INDIRECT_INDEXED
    2,  // ABSOLUTE_INDIRECT
    2,  // ABSOLUTE_INDIRECT_LONG
    2,  // ABSOLUTE_INDEXED_INDIRECT
    0,  // IMPLIED_ACCUMULATOR
    2,  // MOVE
    2,  // STACK_ABSOLUTE
    1,  // PEI_DIRECT_PAGE_INDIRECT
};

constexpr std::pair<Operation, AddressMode> opcode_table[] = {
    {BRK, IMMEDIATE_8},
    {ORA, DIRECT_PAGE_INDEXED_INDIRECT},
    {COP, IMMEDIATE_8},
    {ORA, STACK_RELATIVE},
    {TSB, DIRECT_PAGE},
    {ORA, DIRECT_PAGE},
    {ASL, DIRECT_PAGE},
    {ORA, DIRECT_PAGE_INDIRECT_LONG},
    {PHP, IMPLIED},
    {ORA, IMMEDIATE_M},
    {ASL, IMPLIED_ACCUMULATOR},
    {PHD, IMPLIED},
    {TSB, ABSOLUTE},
    {ORA, ABSOLUTE},
    {ASL, ABSOLUTE},
    {ORA, ABSOLUTE_LONG},
    {BPL, RELATIVE},
    {ORA, DIRECT_PAGE_INDIRECT_INDEXED},
    {ORA, DIRECT_PAGE_INDIRECT},
    {ORA, STACK_RELATIVE_INDIRECT_INDEXED},
    {TRB, DIRECT_PAGE},
    {ORA, DIRECT_PAGE_INDEXED_X},
    {ASL, DIRECT_PAGE_INDEXED_X},
    {ORA, DIRECT_PAGE_INDIRECT_INDEXED_LONG},
    {CLC, IMPLIED},
    {ORA, ABSOLUTE_INDEXED_Y},
    {INC, IMPLIED_ACCUMULATOR},
    {TCS, IMPLIED},
    {TRB, ABSOLUTE},
    {ORA, ABSOLUTE_INDEXED_X},
    {ASL, ABSOLUTE_INDEXED_X},
    {ORA, ABSOLUTE_INDEXED_LONG},
    {JSR, ABSOLUTE},
    {AND, DIRECT_PAGE_INDEXED_INDIRECT},
    {JSL, ABSOLUTE_LONG},
    {AND, STACK_RELATIVE},
    {BIT, DIRECT_PAGE},
    {AND, DIRECT_PAGE},
    {ROL, DIRECT_PAGE},
    {AND, DIRECT_PAGE_INDIRECT_LONG},
    {PLP, IMPLIED},
    {AND, IMMEDIATE_M},
    {ROL, IMPLIED_ACCUMULATOR},
    {PLD, IMPLIED},
    {BIT, ABSOLUTE},
    {AND, ABSOLUTE},
    {ROL, ABSOLUTE},
    {AND, ABSOLUTE_LONG},
    {BMI, RELATIVE},
    {AND, DIRECT_PAGE_INDIRECT_INDEXED},
    {AND, DIRECT_PAGE_INDIRECT},
    {AND, STACK_RELATIVE_INDIRECT_INDEXED},
    {BIT, DIRECT_PAGE_INDEXED_X},
    {AND, DIRECT_PAGE_INDEXED_X},
    {ROL, DIRECT_PAGE_INDEXED_X},
    {AND, DIRECT_PAGE_INDIRECT_INDEXED_LONG},
    {SEC, IMPLIED},
    {AND, ABSOLUTE_INDEXED_Y},
    {DEC, IMPLIED_ACCUMULATOR},
    {TSC, IMPLIED},
    {BIT, ABSOLUTE_INDEXED_X},
    {AND, ABSOLUTE_INDEXED_X},
    {ROL, ABSOLUTE_INDEXED_X},
    {AND, ABSOLUTE_INDEXED_LONG},
    {RTI, IMPLIED},
    {EOR, DIRECT_PAGE_INDEXED_INDIRECT},
    {WDM, IMMEDIATE_8},
    {EOR, STACK_RELATIVE},
    {MVP, MOVE},
    {EOR, DIRECT_PAGE},
    {LSR, DIRECT_PAGE},
    {EOR, DIRECT_PAGE_INDIRECT_LONG},
    {PHA, IMPLIED},
    {EOR, IMMEDIATE_M},
    {LSR, IMPLIED_ACCUMULATOR},
    {PHK, IMPLIED},
    {JMP, ABSOLUTE},
    {EOR, ABSOLUTE},
    {LSR, ABSOLUTE},
    {EOR, ABSOLUTE_LONG},
    {BVC, RELATIVE},
    {EOR, DIRECT_PAGE_INDIRECT_INDEXED},
    {EOR, DIRECT_PAGE_INDIRECT},
    {EOR, STACK_RELATIVE_INDIRECT_INDEXED},
    {MVN, MOVE},
    {EOR, DIRECT_PAGE_INDEXED_X},
    {LSR, DIRECT_PAGE_INDEXED_X},
    {EOR, DIRECT_PAGE_INDIRECT_INDEXED_LONG},
    {CLI, IMPLIED},
    {EOR, ABSOLUTE_INDEXED_Y},
    {PHY, IMPLIED},
    {TCD, IMPLIED},
    {JMP, ABSOLUTE_LONG},
    {EOR, ABSOLUTE_INDEXED_X},
    {LSR, ABSOLUTE_INDEXED_X},
    {EOR, ABSOLUTE_INDEXED_LONG},
    {RTS, IMPLIED},
    {ADC, DIRECT_PAGE_INDEXED_INDIRECT},
    {PER, RELATIVE_LONG},
    {ADC, STACK_RELATIVE},
    {STZ, DIRECT_PAGE},
    {ADC, DIRECT_PAGE},
    {ROR, DIRECT_PAGE},
    {ADC, DIRECT_PAGE_INDIRECT_LONG},
    {PLA, IMPLIED},
    {ADC, IMMEDIATE_M},
    {ROR, IMPLIED_ACCUMULATOR},
    {RTL, IMPLIED},
    {JMP, ABSOLUTE_INDIRECT},
    {ADC, ABSOLUTE},
    {ROR, ABSOLUTE},
    {ADC, ABSOLUTE_LONG},
    {BVS, RELATIVE},
    {ADC, DIRECT_PAGE_INDIRECT_INDEXED},
    {ADC, DIRECT_PAGE_INDIRECT},
    {ADC, STACK_RELATIVE_INDIRECT_INDEXED},
    {STZ, DIRECT_PAGE_INDEXED_X},
    {ADC, DIRECT_PAGE_INDEXED_X},
    {ROR, DIRECT_PAGE_INDEXED_X},
    {ADC, DIRECT_PAGE_INDIRECT_INDEXED_LONG},
    {SEI, IMPLIED},
    {ADC, ABSOLUTE_INDEXED_Y},
    {PLY, IMPLIED},
    {TDC, IMPLIED},
    {JMP, ABSOLUTE_INDEXED_INDIRECT},
    {ADC, ABSOLUTE_INDEXED_X},
    {ROR, ABSOLUTE_INDEXED_X},
    {ADC, ABSOLUTE_INDEXED_LONG},
    {BRA, RELATIVE},
    {STA, DIRECT_PAGE_INDEXED_INDIRECT},
    {BRL, RELATIVE_LONG},
    {STA, STACK_RELATIVE},
    {STY, DIRECT_PAGE},
    {STA, DIRECT_PAGE},
    {STX, DIRECT_PAGE},
    {STA, DIRECT_PAGE_INDIRECT_LONG},
    {DEY, IMPLIED},
    {BIT, IMMEDIATE_M},
    {TXA, IMPLIED},
    {PHB, IMPLIED},
    {STY, ABSOLUTE},
    {STA, ABSOLUTE},
    {STX, ABSOLUTE},
    {STA, ABSOLUTE_LONG},
    {BCC, RELATIVE},
    {STA, DIRECT_PAGE_INDIRECT_INDEXED},
    {STA, DIRECT_PAGE_INDIRECT},
    {STA, STACK_RELATIVE_INDIRECT_INDEXED},
    {STY, DIRECT_PAGE_INDEXED_X},
    {STA, DIRECT_PAGE_INDEXED_X},
    {STX, DIRECT_PAGE_INDEXED_Y},
    {STA, DIRECT_PAGE_INDIRECT_INDEXED_LONG},
    {TYA, IMPLIED},
    {STA, ABSOLUTE_INDEXED_Y},
    {TXS, IMPLIED},
    {TXY, IMPLIED},
    {STZ, ABSOLUTE},
    {STA, ABSOLUTE_INDEXED_X},
    {STZ, ABSOLUTE_INDEXED_X},
    {STA, ABSOLUTE_INDEXED_LONG},
    {LDY, IMMEDIATE_X},
    {LDA, DIRECT_PAGE_INDEXED_INDIRECT},
    {LDX, IMMEDIATE_X},
    {LDA, STACK_RELATIVE},
    {LDY, DIRECT_PAGE},
    {LDA, DIRECT_PAGE},
    {LDX, DIRECT_PAGE},
    {LDA, DIRECT_PAGE_INDIRECT_LONG},
    {TAY, IMPLIED},
    {LDA, IMMEDIATE_M},
    {TAX, IMPLIED},
    {PLB, IMPLIED},
    {LDY, ABSOLUTE},
    {LDA, ABSOLUTE},
    {LDX, ABSOLUTE},
    {LDA, ABSOLUTE_LONG},
    {BCS, RELATIVE},
    {LDA, DIRECT_PAGE_INDIRECT_INDEXED},
    {LDA, DIRECT_PAGE_INDIRECT},
    {LDA, STACK_RELATIVE_INDIRECT_INDEXED},
    {LDY, DIRECT_PAGE_INDEXED_X},
    {LDA, DIRECT_PAGE_INDEXED_X},
    {LDX, DIRECT_PAGE_INDEXED_Y},
    {LDA, DIRECT_PAGE_INDIRECT_INDEXED_LONG},
    {CLV, IMPLIED},
    {LDA, ABSOLUTE_INDEXED_Y},
    {TSX, IMPLIED},
    {TYX, IMPLIED},
    {LDY, ABSOLUTE_INDEXED_X},
    {LDA, ABSOLUTE_INDEXED_X},
    {LDX, ABSOLUTE_INDEXED_Y},
    {LDA, ABSOLUTE_INDEXED_LONG},
    {CPY, IMMEDIATE_X},
    {CMP, DIRECT_PAGE_INDEXED_INDIRECT},
    {REP, IMMEDIATE_8},
    {CMP, STACK_RELATIVE},
    {CPY, DIRECT_PAGE},
    {CMP, DIRECT_PAGE},
    {DEC, DIRECT_PAGE},
    {CMP, DIRECT_PAGE_INDIRECT_LONG},
    {INY, IMPLIED},
    {CMP, IMMEDIATE_M},
    {DEX, IMPLIED},
    {WAI, IMPLIED},
    {CPY, ABSOLUTE},
    {CMP, ABSOLUTE},
    {DEC, ABSOLUTE},
    {CMP, ABSOLUTE_LONG},
    {BNE, RELATIVE},
    {CMP, DIRECT_PAGE_INDIRECT_INDEXED},
    {CMP, DIRECT_PAGE_INDIRECT},
    {CMP, DIRECT_PAGE_INDIRECT},
    {PEI, PEI_DIRECT_PAGE_INDIRECT},
    {CMP, DIRECT_PAGE_INDEXED_X},
    {DEC, DIRECT_PAGE_INDEXED_X},
    {CMP, DIRECT_PAGE_INDIRECT_INDEXED_LONG},
    {CLD, IMPLIED},
    {CMP, ABSOLUTE_INDEXED_Y},
    {PHX, IMPLIED},
    {STP, IMPLIED},
    {JML, ABSOLUTE_INDIRECT_LONG},
    {CMP, ABSOLUTE_INDEXED_X},
    {DEC, ABSOLUTE_INDEXED_X},
    {CMP, ABSOLUTE_INDEXED_LONG},
    {CPX, IMMEDIATE_X},
    {SBC, DIRECT_PAGE_INDEXED_INDIRECT},
    {SEP, IMMEDIATE_8},
    {SBC, STACK_RELATIVE},
    {CPX, DIRECT_PAGE},
    {SBC, DIRECT_PAGE},
    {INC, DIRECT_PAGE},
    {SBC, DIRECT_PAGE_INDIRECT_LONG},
    {INX, IMPLIED},
    {SBC, IMMEDIATE_M},
    {NOP, IMPLIED},
    {XBA, IMPLIED},
    {CPX, ABSOLUTE},
    {SBC, ABSOLUTE},
    {INC, ABSOLUTE},
    {SBC, ABSOLUTE_LONG},
    {BEQ, RELATIVE},
    {SBC, DIRECT_PAGE_INDIRECT_INDEXED},
    {SBC, DIRECT_PAGE_INDIRECT},
    {SBC, STACK_RELATIVE_INDIRECT_INDEXED},
    {PEA, STACK_ABSOLUTE},
    {SBC, DIRECT_PAGE_INDEXED_X},
    {INC, DIRECT_PAGE_INDEXED_X},
    {SBC, DIRECT_PAGE_INDIRECT_INDEXED_LONG},
    {SED, IMPLIED},
    {SBC, ABSOLUTE_INDEXED_Y},
    {PLX, IMPLIED},
    {XCE, IMPLIED},
    {JSR, ABSOLUTE_INDEXED_INDIRECT},
    {SBC, ABSOLUTE_INDEXED_X},
    {INC, ABSOLUTE_INDEXED_X},
    {SBC, ABSOLUTE_INDEXED_LONG},
};

constexpr const char *operation_names[] = {
    "adc", "and", "asl", "bcc", "bcs", "beq", "bit", "bmi", "bne", "bpl", "bra",
    "brk", "brl", "bvc", "bvs", "clc", "cld", "cli", "clv", "cmp", "cop", "cpx",
    "cpy", "dec", "dex", "dey", "eor", "inc", "inx", "iny", "jml", "jmp", "jsl",
    "jsr", "lda", "ldx", "ldy", "lsr", "mvn", "mvp", "nop", "ora", "pea", "pei",
    "per", "pha", "phb", "phd", "phk", "php", "phx", "phy", "pla", "plb", "pld",
    "plp", "plx", "ply", "rep", "rol", "ror", "rti", "rtl", "rts", "sbc", "sec",
    "sed", "sei", "sep", "sta", "stp", "stx", "sty", "stz", "tax", "tay", "tcd",
    "tcs", "tdc", "trb", "tsb", "tsc", "tsx", "txa", "txs", "txy", "tya", "tyx",
    "wai", "wdm", "xba", "xce",
};
